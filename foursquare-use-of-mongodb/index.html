<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"> <head> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> Foursquare's Use of MongoDB &middot; Inteist </title> <!-- CSS --> <link rel="stylesheet" href="/public/css/poole.css"> <link rel="stylesheet" href="/public/css/hyde.css"> <link href='//fonts.googleapis.com/css?family=Fjalla+One|Lato|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <link rel="canonical" href=" http://localhost:4000/foursquare-use-of-mongodb/" /> <!-- Default pygments --> <link rel="stylesheet" href="/public/css/extra/pygments/monokai.css"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png"> <link rel="shortcut icon" href="/public/favicon.ico"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <!-- Google Analytics --> <script> (function (i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m) })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga'); ga('create', 'UA-2630485-14', 'auto'); ga('send', 'pageview'); </script> <!-- Google Adsense Validation --> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9336216488761027" crossorigin="anonymous"></script> </head> <body> <div class="sidebar"> <div class="container sidebar-sticky"> <div class="sidebar-about"> <h1 id="site-name"> <a href="/"> Inteist </a> </h1> <p class="lead">I code for living</p> </div> <nav class="sidebar-nav"> <!-- <a class="sidebar-nav-item" href="/">Home</a> --> <a class="sidebar-nav-item" href="/pages/">Pages</a> <a class="sidebar-nav-item" href="/dev-resources/">Dev Resources</a> <a class="sidebar-nav-item" href="/figlet/">Figlet</a> <a class="sidebar-nav-item" href="/git/">Git Tips</a> <div class="sidebar-spacer">&nbsp;</div> <a class="sidebar-nav-item" href="/tags/">Tags</a> <a class="sidebar-nav-item" href="/archive/">Archive</a> <a class="sidebar-nav-item" href="/me/">Me</a> </nav> <p class="copyright">&copy; 2010 - 2022</p> </div> </div> <div class="content container"> <div class="reading-time"> <p title="544 words">~ 4 min read</p> </div> <div class="post link-underline"> <h1 class="post-title">Foursquare's Use of MongoDB</h1> <span class="post-date">15 Dec 2010</span> <p><img class="aligncenter size-medium wp-image-422" title="Foursquare_logo" src="http://inteist.com/media/500px-Foursquare_logo.svg_-300x83.png" alt="" width="300" height="83" /><a src="http://inteist.com/media/1605635.png"><img class="aligncenter size-medium wp-image-421" title="MongoDB logo bright" src="http://inteist.com/media/1605635-300x100.png" alt="" width="300" height="100" /></a></p> <p>I have been to a presentation by Harry Heyman - the first non founder employee of Foursquare. He presented on the Foursquare's usage of <a href="http://www.mongodb.org/" target="_blank">MongoDB</a>, a rapidly gaining popularity NoSQL database. Quickly - the idea behind NoSQL database that it is not based on a relational model as most traditional databases but rather on a document model.</p> <p>Harry had many interesting things but the one thing that was especially interesting to me was that they <strong>basically run all the DB operations of FourSquare in RAM! </strong>Yes that's right. They employ the extra large memory instances on EC2, running with 64GB or RAM and they shard whenever they start approaching certain limits of RAM.</p> <p>The outages they had in early October were because they hit the memory limit and the databases started to page in and out the data from the hard drives to the memory and back and this quickly brought them down.</p> <p>He mentioned that this is however not Mongo's fault and this would have happened with any database they would have used. Which is interesting by itself because it means that the way the application is engineered - the requirements is that all the data that they operate has to be in RAM for the application to be fast enough. I bet there is a lot of smart engineers working at Foursquare and there has to be a good reason for that and in fact Harry mentioned that they basically have to have almost all the checkins available in memory due to the nature of the queries they have to perform on the data. Â He also mentioned that when (this seemed more of a "when" rather than "if") they move to dedicated servers with solid state drives, they should not have that limit anymore because then the hard drives (SSDs) in that case will be fast enough.</p> <p>For me all this was very surprising and I am still a little puzzled about it and wonder whether there is/was no way of engineering the application so that they don't have to keep pretty much all their data (about 5 million users and 160 million checkins at the moment), all in RAM.</p> <p style="text-align: center;"><a href="http://bit.ly/e0p3b4" target="_blank">Slides of the presentation</a></p> <p style="text-align: left;"><strong>UPDATE (Dec 15 2010) a few related links:</strong></p> <p style="text-align: left;"><a href="http://blog.foursquare.com/2010/10/05/so-that-was-a-bummer/">Official blog from Foursquare</a></p> <p style="text-align: left;"><a href="http://news.ycombinator.com/item?id=1769761">Interesting discussion at YCombinator hacker news</a></p> <p style="text-align: left;"><a href=" http://nosql.mypopescu.com/post/1265191137/foursquare-mongodb-outage-post-mortem">Some notes of Alex Popescu from NoSQL blog</a></p> <p style="text-align: left;"> <p style="text-align: left;"> <p style="text-align: left;"><strong>UPDATE (Dec 17 2010) - 10gen posted the video of the meetup</strong></p> <p style="text-align: left;"><strong> </strong><a href="http://www.10gen.com/video/misc/foursquare">MongoDB and Foursquare video</a></p> <p><!-- This script tag will cause the Brightcove Players defined above it to be created as soon as the line is read by the browser. If you wish to have the player instantiated only after the rest of the HTML is processed and the page load is complete, remove the line. --><br /> <script type="text/javascript">// <![CDATA[<br /> brightcove.createExperiences();<br /> // ]]></script></p> <p><!-- End of Brightcove Player --></p> <p style="text-align: left;"> <p style="text-align: center;"><em>The foursquare and MongoDB logos are properties of their respected owners.</em></p> </p></p></p> </div> <!-- TAGs LIST --> <div class="tag-links-list" style="text-align: right;"> <a href="/tag/technical/" <span style="font-size: .6rem;">#technical</span></a>&nbsp;&nbsp; <a href="/tag/db/" <span style="font-size: .6rem;">#db</span></a>&nbsp;&nbsp; <a href="/tag/mongodb/" <span style="font-size: .6rem;">#mongodb</span></a>&nbsp;&nbsp; </div> <!-- SIMILAR POSTS --> <div class="related"> <h3 id="similar-posts">Similar Posts</h3> <ul class="related-posts"> <li> <h4> <a href="/android-working-with-gradle-purging-gradle-cache/"> Android - working with Gradle: purging gradle cache </a> <small>13 Jan 2017</small> </h4> </li> <li> <h4> <a href="/git-trello-integration/"> Git + Trello Integration </a> <small>23 May 2016</small> </h4> </li> <li> <h4> <a href="/lean-and-fast-how-to-shrink-down-and-lean-down-android-apps/"> Lean and Fast - How to shrink down and lean down Android apps </a> <small>20 May 2016</small> </h4> </li> <li> <h4> <a href="/git-salvaging-lost-commits/"> Git - Salvaging Lost Commits </a> <small>07 Mar 2016</small> </h4> </li> <li> <h4> <a href="/tarantool-fast-in-memory-database-for-hot-data/"> Tarantool - Fast in Memory Database for HOT DATA </a> <small>10 Dec 2015</small> </h4> </li> </ul> </div> <!-- LATEST POSTS --> <div class="related"> <h3 id="latest-posts">Latest Posts</h3> <ul class="related-posts"> <li> <h4> <a href="/scheduling-randomized-cron-within-an-hour/"> Scheduling randomized cron - within an hour or within a minute </a> &nbsp;&nbsp;<small>18 Feb 2017</small> </h4> </li> <li> <h4> <a href="/android-working-with-gradle-purging-gradle-cache/"> Android - working with Gradle: purging gradle cache </a> &nbsp;&nbsp;<small>13 Jan 2017</small> </h4> </li> <li> <h4> <a href="/git-trello-integration/"> Git + Trello Integration </a> &nbsp;&nbsp;<small>23 May 2016</small> </h4> </li> <li> <h4> <a href="/google-i-o-videos-list/"> Google I/O Videos List </a> &nbsp;&nbsp;<small>20 May 2016</small> </h4> </li> </ul> </div> <div id="disqus_thread"></div> <script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = 'inteist'; /* * * DON'T EDIT BELOW THIS LINE * * */ (function () { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> </div> </body> </html>
