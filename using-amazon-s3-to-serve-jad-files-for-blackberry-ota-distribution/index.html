<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <!-- Enable responsiveness on mobile devices--> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> Using Amazon S3 to Serve JAD Files for BlackBerry OTA Distribution &middot; Inteist </title> <!-- CSS --> <link rel="stylesheet" href="/public/css/poole.css"> <link rel="stylesheet" href="/public/css/hyde.css"> <link href='http://fonts.googleapis.com/css?family=Fjalla+One|Lato|Droid+Sans+Mono' rel='stylesheet' type='text/css'> <!-- Default pygments --> <link rel="stylesheet" href="/public/css/extra/pygments/monokai.css"> <!-- Icons --> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png"> <link rel="shortcut icon" href="/public/favicon.ico"> <!-- RSS --> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> </head> <body> <div class="sidebar"> <div class="container sidebar-sticky"> <div class="sidebar-about"> <h1> <a href="/"> Inteist </a> </h1> <p class="lead">I code for living</p> </div> <nav class="sidebar-nav"> <!-- <a class="sidebar-nav-item" href="/">Home</a> --> <a class="sidebar-nav-item" href="/dev-resources">Dev Resources</a> <div class="sidebar-spacer">&nbsp;</div> <a class="sidebar-nav-item" href="/tags">Tags</a> <a class="sidebar-nav-item" href="/archive">Archive</a> <a class="sidebar-nav-item" href="/about">About</a> </nav> <p class="copyright">&copy; 2010 </p> </div> </div> <div class="content container"> <div class="reading-time"> <p title="1163 words">~ 9 min read</p> </div> <div class="post"> <h1 class="post-title">Using Amazon S3 to Serve JAD Files for BlackBerry OTA Distribution</h1> <span class="post-date">04 Apr 2010</span> <div class="link-underline"> <p>If you don't want the preamble of why I wanted to serve JAD files from Amazon S3, skip to the second paragraph.</p> <p>I have recently came across the need to push OTA update of the <a href="http://www.comitic.com/blackberry/dailyhoroscope-application/" target="_blank">DailyHoroscope application for BlackBerry</a>. I conjectured that OTA updates have different behavior and thus different impact on the web server. There are still many people using their smartphones in general and BlackBerries in particular over the slower EDGE connections as opposed to 3G, not to mention 4G and/or WiMax. So to download 300K file over EDGE connection in the real usage example can take anywhere between 10 seconds to couple minutes. All this time the webserver's thread serving this specific client will remain running. So it seems like you (or rather your server) can be in a nasty situation when 1000 users simultaneously or almost simultaneously decide to do the OTA update. Also quick calculation with Amazon WS calculator shows that serving files from S3 would be rather cheap even comparing to renting a cheap VPS for that purpose. My estimate was that the whole upgrade process (considering the fact that almost all the users update from S3) will cost me about $15. And this is independent of the time span. For $15 you could get a very cheap VPS for one month (if you are lucky). So it seemed like a no brainer. It indeed was until I faced a few problems with setting this up which I will cover here so that you don't have to spend much time looking for solutions if you want to do the same.</p> <p>Setting up S3 is a breeze. Using it - not so much. It is just like any other service pretty much - when you want to sign up and call sales you are answered immediately but if you have a problem and need customer service, well, you can be on hold quite a while. If you have Amazon account already set up, you can use this account. You will have the option to opt for the payment to any of the payment options (now it seems that this is only credit cards) already on file with Amazon or you could add a new credit card so that your S3 bill is billed separately.</p> <p><!--more--></p> <p>When you signed up, you are almost ready to begin using S3. Once you receive confirmation email which can take a few minutes until your request is processed and billing information verified, you are set to go.</p> <ul> <li>Open your <a href="http://aws.amazon.com/account/" target="_blank">Amazon account dashboard</a> and login with your Amazon account you had or just created</li> <li>Click on <strong>Security Credentials</strong></li> <li>Under the <strong>Access Credentials</strong> table, look at the first tab - <strong>Access Keys</strong></li> <li>Next to your access key, will be a column <strong>Secret Access Key </strong>which will have the secret key hidden from the screen.</li> <li>Press the <strong>Show</strong> and your secret access key will be revealed</li> </ul> <p>Now you can use this information to log in to S3 and start uploading files. To access S3 you can use S3Fox from any platform since it is FireFox plugin. You can use <a href="http://cyberduck.ch/" target="_blank">CyberDuck </a>if you are on Mac which is an excellent free general purpose FTP client which also supports WebDav and SFTP. If you are on Windows, there is also free and feature rich client <a href="http://cloudberrylab.com/?page=cloudberry-explorer-amazon-s3" target="_blank">CloudBerry</a>. S3Fox is very nice and fast and you do not have to install anything on the system, only plugin for FireFox, but I will be using CloudBerry since we will need to set custom Content-Type for the JAD and COD files and CloudBerry is more feature rich than S3Fox.</p> <ul> <li>Open CloudBerry</li> <li><strong>Enter your credentials</strong> and open your S3 account</li> <li><strong>Create a bucket</strong> - it has to have unique system wide name like a domain name (actually subdomain, because after it is created it is references by http://yourUniqueName.s3.amazonaws.com)</li> <li>Enter into the bucket and <strong>create folders, or just upload the files</strong> you want to serve. If you like me want to serve OTA BlackBerry application, you probably want to create a separate folder for each release</li> <li>After you create the folder, use the ACL (access control levels/list) menu button <a src="http://inteist.com/media/cloudberry-acl-button.png"><img class="alignnone size-full wp-image-213" style="border: 0pt none;" title="cloudberry-acl-button" src="http://inteist.com/media/cloudberry-acl-button.png" alt="" width="43" height="30" /></a>to open the ACL controls</li> </ul> <p style="text-align: center;"><a src="http://inteist.com/media/cloudberry-acl-controls1.png"><img class="size-full wp-image-210 aligncenter" style="border: 0pt none;" title="cloudberry-acl-controls" src="http://inteist.com/media/cloudberry-acl-controls1.png" alt="" width="469" height="129" /></a></p> <p style="text-align: center;"> <ul> <li>Using the ACL controls, give <strong>"Read" access to "All Users</strong>" (note that if you place check mark on the bottom "Apply for all subfolders and files" the permissions will propagate down the tree)</li> </ul> <p>Now the whole world can read the files you uploaded. The problem with BlackBerry OTA distribution is that Amazon does not send the right mime-types in the HTML Content-type header. And this is something that you will need to get fixed before people can actually install your application over the air directly from S3.</p> <p>The right content types for the the JAD and COD are:</p> <ul> <li> <div>jad -Â  <strong> text/vnd.sun.j2me.app-descriptor</strong></div> </li> <li> <div>cod - <strong>application/vnd.rim.cod</strong></div> </li> </ul> <p>So using the custom HTTP headers menu button <a src="http://inteist.com/media/cloudberry-custom-http-headers-for-s3-menu-butto.png"><img class="alignnone size-full wp-image-216" style="border: 0pt none;" title="cloudberry-custom-http-headers-for-s3-menu-butto" src="http://inteist.com/media/cloudberry-custom-http-headers-for-s3-menu-butto.png" alt="" width="131" height="32" /></a> we will be setting those types for JAD file and <strong>all </strong>the COD files respectively.</p> <ul> <li>Select your JAD file and click on "Set HTTP Headers" button</li> </ul> <p>You will get the custom HTTP headers dialog:</p> <p style="text-align: center;"><a src="http://inteist.com/media/cloudberry-custom-http-headers-dialog.png"><img class="size-full wp-image-217 aligncenter" style="border: 0pt none;" title="cloudberry-custom-http-headers-dialog" src="http://inteist.com/media/cloudberry-custom-http-headers-dialog.png" alt="" width="507" height="198" /></a></p> <ul> <li>Select the <strong>"Content-Type"</strong> field and replace it with the <strong>text/vnd.sun.j2me.app-descriptor</strong> for the value</li> </ul> <p>Now you can repeat the above step for each COD file individually, or you can select all the COD files and set the headers at once but then you would need to add the <strong>"Content-Type" </strong>header manually for the right COD mime type - <strong>application/vnd.rim.cod</strong>.<strong> </strong>Just use "Add" and in the HTTP-Header enter "Content-Type" and in the Value enter "application/vnd.rim.cod". You should see something like the following dialog</p> <p style="text-align: center;"><a src="http://inteist.com/media/cloudberry-custom-http-headers-dialog-manual-add-filled.png"><img class="size-full wp-image-220 aligncenter" style="border: 0pt none;" title="cloudberry-custom-http-headers-dialog-manual-add-filled" src="http://inteist.com/media/cloudberry-custom-http-headers-dialog-manual-add-filled.png" alt="" width="504" height="442" /></a></p> <p><strong>***IMPORTANT to check the "Keep existing headers" </strong>or you will loose all your default defined headers which is not good in most cases.</p> <p>That's it, you are DONE! Check that you did everything right by pointing your BB browser to http://yourUniqueName.s3.amazonaws.com/yourReleaseFolder/AppName.jad and make sure that you can install the application from there. If you did everything right it should work.</p> <p>Overall S3 seems like a very nice (and apparently very cheap) service and anyone who serves lots of static content should consider using it for that purpose. But not everything seems so pink in the world of S3 and I am sure you will face many other small problems and nuances while setting it up as I did for my task. But hopefully if serving BlackBerry application is all you want, you should now have everything to get you started.</p> </div> </div> <!-- SIMILAR POSTS --> <div class="related"> </div> <!-- LATEST POSTS --> <div class="related"> <h3>Latest Posts</h3> <ul class="related-posts"> <li> <h4> <a href="/javascript-generate-pseudo-random-set"> Javascript - Generate Pseudo Random NON REPEATING Array of Numbers </a> <small>09 May 2015</small> </43> </li> <li> <h4> <a href="/concise-code-readability-vs-obscurity"> Concise Code - Where to Draw Readability and Obscurity Line? </a> <small>08 May 2015</small> </43> </li> <li> <h4> <a href="/remove-pushed-files-folders-from-git-repo"> Completely Remove Pushed Files and/or Folders from Git Repository </a> <small>03 May 2015</small> </43> </li> <li> <h4> <a href="/atom-highlighting-search-results-in-a-dark-theme"> Atom.io Highlighting the Search Results in a Dark Theme </a> <small>29 Apr 2015</small> </43> </li> </ul> </div> <div id="disqus_thread"></div> <script type="text/javascript"> /* * * CONFIGURATION VARIABLES * * */ var disqus_shortname = 'inteist'; /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> </div> <!-- Google Analytics --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-2630485-14', 'auto'); ga('send', 'pageview'); </script> </body> </html>
